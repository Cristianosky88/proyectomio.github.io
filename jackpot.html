<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Registro de Jackpot</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
  <style>
    /* ===== ESTILOS GENERALES ===== */
    * {
        box-sizing: border-box;
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        line-height: 1.6;
        color: #212529;
        background-color: #f8f9fa;
    }

    /* ===== SECCIONES DEL FORMULARIO ===== */
    .section {
        border: 1px solid #dee2e6;
        border-radius: 0.375rem;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        background-color: #ffffff;
        box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    }

    .section legend {
        font-size: 1.1rem;
        font-weight: 600;
        padding: 0 0.75rem;
        margin-bottom: 1rem;
        color: #495057;
        border: none;
        background-color: transparent;
    }

    /* ===== GRID DEL FORMULARIO ===== */
    .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.25rem;
        align-items: start;
    }

    .form-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .form-group label {
        font-weight: 500;
        color: #374151;
        font-size: 0.95rem;
    }

    /* ===== ASTERISCO REQUERIDO ===== */
    .required-asterisk::after {
        content: ' *';
        color: #dc3545;
        font-weight: bold;
    }

    /* ===== BOTONES ===== */
    .buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-top: 2rem;
        padding: 1.5rem;
        background-color: #f8f9fa;
        border-radius: 0.5rem;
        border: 1px solid #e9ecef;
    }

    .buttons .btn {
        min-width: 150px;
    }

    /* ===== RESUMEN ===== */
    #resumen {
        padding: 1.5rem;
        background-color: #e7f3ff;
        border: 2px solid #b3d9ff;
        border-radius: 0.5rem;
        min-height: 60px;
        font-family: 'Courier New', monospace;
        white-space: pre-line;
        line-height: 1.8;
    }

    #resumen:empty::before {
        content: "El resumen aparecer√° aqu√≠ despu√©s de generar o guardar...";
        color: #6c757d;
        font-style: italic;
        font-family: inherit;
    }

    /* ===== PREVIEW DE FOTOS ===== */
    #previewFotos {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-top: 1rem;
    }

    #previewFotos img {
        width: 120px;
        height: 120px;
        object-fit: cover;
        border: 2px solid #dee2e6;
        border-radius: 0.5rem;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    #previewFotos img:hover {
        transform: scale(1.05);
        box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.15);
        border-color: #007bff;
    }

    /* ===== TABLA ===== */
    .table-responsive {
        border-radius: 0.5rem;
        overflow: hidden;
        box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    }

    .table thead th {
        background-color: #f8f9fa;
        border-bottom: 2px solid #dee2e6;
        font-weight: 600;
        color: #495057;
        text-transform: uppercase;
        font-size: 0.85rem;
        letter-spacing: 0.5px;
    }

    .table tbody tr:hover {
        background-color: #f5f5f5;
    }

    /* ===== MODO OSCURO ===== */
    .dark-mode {
        background-color: #1a1a1a;
        color: #e9ecef;
    }

    .dark-mode body {
        background-color: #1a1a1a;
        color: #e9ecef;
    }

    .dark-mode .section {
        background-color: #2d3748;
        border-color: #4a5568;
        color: #e9ecef;
    }

    .dark-mode .section legend {
        color: #cbd5e0;
    }

    .dark-mode .form-group label {
        color: #cbd5e0;
    }

    .dark-mode .form-control,
    .dark-mode .form-select {
        background-color: #374151;
        border-color: #4a5568;
        color: #e9ecef;
    }

    .dark-mode .form-control:focus,
    .dark-mode .form-select:focus {
        background-color: #374151;
        border-color: #60a5fa;
        color: #e9ecef;
        box-shadow: 0 0 0 0.2rem rgba(96, 165, 250, 0.25);
    }

    .dark-mode #resumen {
        background-color: #1e3a5f;
        border-color: #3182ce;
        color: #e9ecef;
    }

    .dark-mode .buttons {
        background-color: #2d3748;
        border-color: #4a5568;
    }

    .dark-mode .table {
        color: #e9ecef;
    }

    .dark-mode .table thead th {
        background-color: #374151;
        border-color: #4a5568;
        color: #cbd5e0;
    }

    .dark-mode .table tbody tr:hover {
        background-color: #374151;
    }

    .dark-mode .table-striped tbody tr:nth-of-type(odd) {
        background-color: rgba(255, 255, 255, 0.05);
    }

    /* ===== RESPONSIVO ===== */
    @media (max-width: 768px) {
        .form-grid {
            grid-template-columns: 1fr;
        }

        .buttons {
            flex-direction: column;
        }

        .buttons .btn {
            min-width: unset;
            width: 100%;
        }

        .container {
            padding-left: 1rem;
            padding-right: 1rem;
        }
    }

    /* ===== ANIMACIONES ===== */
    .section {
        animation: slideInUp 0.3s ease-out;
    }

    @keyframes slideInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .btn {
        transition: all 0.2s ease;
    }

    .btn:hover {
        transform: translateY(-1px);
    }

    /* ===== MEJORAS VISUALES ===== */
    .form-control:focus,
    .form-select:focus {
        border-color: #007bff;
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
    }

    .invalid-feedback {
        display: block;
        margin-top: 0.5rem;
        font-size: 0.875rem;
    }

    .form-text {
        color: #6c757d;
        font-size: 0.875rem;
        margin-top: 0.25rem;
    }

    /* ===== HEADER ===== */
    header h1 {
        color: #2563eb;
        font-weight: 700;
    }

    .dark-mode header h1 {
        color: #60a5fa;
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <header class="mb-4 d-flex flex-wrap align-items-center gap-3">
      <div>
        <h1 class="mb-0">Registro de Jackpot</h1>
        <div class="text-muted small">Formulario interno - Control y Auditor√≠a</div>
      </div>
      <div class="ms-auto d-flex gap-2">
        <button class="btn btn-outline-dark btn-sm" id="btnDarkMode" type="button" title="Alternar modo oscuro">
          <i class="fa-solid fa-moon"></i>
        </button>
        <button class="btn btn-outline-secondary btn-sm" type="button" id="btnLimpiarTodo" title="Limpiar formulario">
          <i class="fa-solid fa-broom"></i>
        </button>
      </div>
    </header>

    <form id="formJackpot" autocomplete="off" novalidate>
      <fieldset class="section">
        <legend>üìû Informaci√≥n de Contacto CCTV</legend>
        <div class="form-grid">
          <div class="form-group">
            <label for="hora_cctv" class="required-asterisk">Hora de aviso a CCTV</label>
            <input type="time" id="hora_cctv" name="hora_cctv" class="form-control" required>
          </div>
          <div class="form-group">
            <label for="quien_llama" class="required-asterisk">Qui√©n realiza la llamada y descarga</label>
            <select id="quien_llama" name="quien_llama" class="form-select" required>
              <option value="">Seleccionar...</option>
              <option value="Enc.">Enc.</option>
              <option value="As.">As.</option>
              <option value="Op.">Op.</option>
            </select>
          </div>
          <div class="form-group">
            <label for="nombre_llama" class="required-asterisk">Nombre del personal (llamada y descarga)</label>
            <input type="text" id="nombre_llama" name="nombre_llama" class="form-control" placeholder="Nombre del personal" required>
          </div>
        </div>
      </fieldset>

      <fieldset class="section">
        <legend>üé∞ Informaci√≥n del Jackpot</legend>
        <div class="form-grid">
          <div class="form-group">
            <label for="nro_maquina" class="required-asterisk">N¬∞ M√°quina (6 d√≠gitos)</label>
            <input type="text" id="nro_maquina" name="nro_maquina" class="form-control" pattern="[0-9]{6}" maxlength="6" inputmode="numeric" required placeholder="Ej: 120305" aria-describedby="helpNroMaquina">
            <div id="helpNroMaquina" class="form-text">Debe contener exactamente 6 d√≠gitos num√©ricos.</div>
            <div class="invalid-feedback">Ingrese exactamente 6 d√≠gitos (0-9). Ejemplo v√°lido: 120305</div>
          </div>
          <div class="form-group">
            <label for="importe" class="required-asterisk">Importe Jackpot ($)</label>
            <input type="number" id="importe" name="importe" step="0.01" min="0" class="form-control" placeholder="0,00" required>
          </div>
          <div class="form-group">
            <label for="hora_revision" class="required-asterisk">Hora de revisi√≥n</label>
            <input type="time" id="hora_revision" name="hora_revision" class="form-control" required>
          </div>
        </div>
      </fieldset>

      <fieldset class="section">
        <legend>üë§ Informaci√≥n del Cliente</legend>
        <div class="form-grid">
          <div class="form-group">
            <label for="tipo_cliente" class="required-asterisk">Cliente o Clienta</label>
            <select id="tipo_cliente" name="tipo_cliente" class="form-select" required>
              <option value="">Seleccionar...</option>
              <option value="cliente">Cliente</option>
              <option value="clienta">Clienta</option>
            </select>
          </div>
          <div class="form-group">
            <label for="nombre_cliente" class="required-asterisk">Nombre del Cliente/a</label>
            <input type="text" id="nombre_cliente" name="nombre_cliente" class="form-control" placeholder="Nombre completo" required>
          </div>
        </div>
      </fieldset>

      <fieldset class="section">
        <legend>üí≥ Informaci√≥n de Pago</legend>
        <div class="form-grid">
          <div class="form-group">
            <label for="hora_pago" class="required-asterisk">Hora de pago en caja</label>
            <input type="time" id="hora_pago" name="hora_pago" class="form-control" required>
          </div>
          <div class="form-group">
            <label for="quien_paga" class="required-asterisk">Qui√©n realiza el pago</label>
            <select id="quien_paga" name="quien_paga" class="form-select" required>
              <option value="">Seleccionar...</option>
              <option value="Jefe de Caja">Jefe de Caja</option>
              <option value="As. de Caja">As. de Caja</option>
              <option value="Cajera">Cajera</option>
            </select>
          </div>
          <div class="form-group">
            <label for="nombre_paga" class="required-asterisk">Nombre del personal que paga</label>
            <input type="text" id="nombre_paga" name="nombre_paga" class="form-control" placeholder="Nombre del personal" required>
          </div>
          <div class="form-group">
            <label for="hora_descarga" class="required-asterisk">Hora de registro y descarga</label>
            <input type="time" id="hora_descarga" name="hora_descarga" class="form-control" required>
          </div>
        </div>
      </fieldset>

      <fieldset class="section">
        <legend>üéÆ Informaci√≥n Adicional</legend>
        <div class="form-grid">
          <div class="form-group">
            <label for="juego">Juego</label>
            <select id="juego" name="juego" class="form-select">
              <option value="">Seleccionar juego...</option>
              <option value="88 FORTUNE">88 FORTUNE</option>
              <option value="BUFFALO">BUFFALO</option>
              <option value="DRAGON LINK">DRAGON LINK</option>
              <option value="LIGHTNING LINK">LIGHTNING LINK</option>
              <option value="WHEEL OF FORTUNE">WHEEL OF FORTUNE</option>
              <option value="ARISTROCRAT">ARISTROCRAT</option>
              <option value="BALLY">BALLY</option>
              <option value="IGT">IGT</option>
              <option value="KONAMI">KONAMI</option>
              <option value="OTRO">Otro (especificar en observaciones)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="pago_manual">Pago Manual</label>
            <input type="number" id="pago_manual" name="pago_manual" class="form-control" step="0.01" min="0" placeholder="0,00">
          </div>
          <div class="form-group">
            <label for="maquina_independiente">Marca M√°quina</label>
            <select id="maquina_independiente" name="maquina_independiente" class="form-select">
              <option value="">Seleccionar marca...</option>
              <option value="BALLY">BALLY</option>
              <option value="ARISTOCRAT">ARISTOCRAT</option>
              <option value="IGT">IGT</option>
              <option value="KONAMI">KONAMI</option>
              <option value="SCIENTIFIC GAMES">SCIENTIFIC GAMES</option>
              <option value="AINSWORTH">AINSWORTH</option>
              <option value="NOVOMATIC">NOVOMATIC</option>
              <option value="OTRO">Otro (especificar)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="observaciones">Observaciones</label>
            <textarea id="observaciones" name="observaciones" class="form-control" rows="3" placeholder="Observaciones adicionales, detalles especiales, etc."></textarea>
          </div>
        </div>
      </fieldset>

      <fieldset class="section">
        <legend>üì∑ Documentaci√≥n</legend>
          <div class="mb-2">
            <label for="fotos" class="form-label">Ap√©ndice 1: Fotos (m√°x 5MB c/u, 12 im√°genes)</label>
            <input type="file" id="fotos" name="fotos" class="form-control" multiple accept="image/*">
            <div class="form-text">Se listar√°n miniaturas. No se suben al servidor todav√≠a.</div>
          </div>
          <div id="previewFotos" class="d-flex flex-wrap gap-2"></div>
      </fieldset>

      <div class="buttons">
        <button type="button" class="btn btn-secondary" id="btnAutocompletar">üîÑ Autocompletar</button>
        <button type="button" class="btn btn-primary" id="btnGenerarResumen">üìã Generar Resumen</button>
        <button type="submit" class="btn btn-success" id="btnGuardar">üíæ Guardar Registro</button>
        <button type="button" class="btn btn-outline-info" id="btnExportarTodo">‚¨áÔ∏è Exportar Todos (JSON)</button>
        <button type="button" class="btn btn-outline-danger" id="btnBorrarRegistros">üóëÔ∏è Borrar Registros</button>
        <button class="btn btn-inicio" type="button" onclick="window.location.href='index.html'">üè† Volver al Inicio</button>
      </div>
    </form>

    <div id="resumen" class="mt-4" aria-live="polite"></div>

    <section class="mt-5">
      <h2 class="h5 mb-3">üìÅ Registros Guardados (Local)</h2>
      <div class="table-responsive">
        <table class="table table-sm table-striped align-middle" id="tablaRegistros">
          <thead class="table-light">
            <tr>
              <th>#</th>
              <th>Fecha/Hora Guardado</th>
              <th>N¬∞ M√°quina</th>
              <th>Importe</th>
              <th>Cliente</th>
              <th>Pago</th>
              <th>Fotos</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody id="tbodyRegistros">
            <tr><td colspan="8" class="text-center text-muted small">Sin registros</td></tr>
          </tbody>
        </table>
      </div>
    </section>
  </div>

  <template id="tplFilaRegistro">
    <tr>
      <td data-col="idx"></td>
      <td data-col="ts"></td>
      <td data-col="nro"></td>
      <td data-col="imp"></td>
      <td data-col="cliente"></td>
      <td data-col="pago"></td>
      <td data-col="fotos"></td>
      <td data-col="acciones">
        <button class="btn btn-sm btn-outline-primary" onclick="verDetalle(this)" title="Ver detalle">
          <i class="fa-solid fa-eye"></i>
        </button>
      </td>
    </tr>
  </template>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/jackpot.js"></script>
</body>
</html>
